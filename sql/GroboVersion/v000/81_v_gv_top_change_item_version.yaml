# The top item versions for each change.

view:
    viewName: V_GV_TOP_CHANGE_ITEM_VERSION
    query: "
        SELECT
                cv.Gv_Change_Id Gv_Change_Id
                , iv.Gv_Item_Id Gv_Item_Id
                , MAX(cv.Gv_Item_Version_Id) Gv_Item_Version_Id
            FROM GV_CHANGE_VERSION cv
            INNER JOIN GV_ITEM_VERSION iv
                ON cv.Gv_Item_Version_Id = iv.Gv_Item_Version_Id
            GROUP BY iv.Gv_Item_Id, cv.Gv_Change_Id
        "
    columns:
        - column:
            name: Gv_Change_Id
            type: int
            constraints:
                - constraint:
                    type: not null
                - constraint:
                    type: foreign key
                    name: V_Gv_Top_Change_Item_Version__Gv_Change_Id_FK
                    table: GV_CHANGE
                    column: Gv_Change_Id
        - column:
            name: Gv_Item_Id
            type: int
            constraints:
                - constraint:
                    type: not null
                - constraint:
                    type: foreign key
                    name: V_Gv_Top_Change_Item_Version__Gv_Item_Id_FK
                    table: GV_ITEM
                    column: Gv_Item_Id
        - column:
            name: Gv_Item_Version_Id
            type: int
            autoIncrement: true
            constraints:
                - constraint:
                    type: foreign key
                    name: V_Gv_Top_Change_Item_Version__Gv_Item_Version_Id_Key
                    table: GV_ITEM_VERSION
                    column: Gv_Item_Version_Id
