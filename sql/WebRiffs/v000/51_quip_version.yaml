# A quip associated with the quip item's version.

# The relationship between branches and quips is in the changes assigned to
# a quip.

# May want to look at splitting the data from the quip itself, especially when
# we have large data associated with each quip (e.g. voice recordings).

table:
    tableName: QUIP_VERSION
    columns:
        - column:
            name: Gv_Item_Version_Id
            type: int
            constraints:
                - constraint:
                    type: not null
                - constraint:
                    type: primary key
                    name: Quip_Version__Gv_Item_Version_Id_PK
                - constraint:
                    type: unique index
                    name: Quip_Version__Gv_Item_Version_Id_IDX
                - constraint:
                    type: foreign key
                    name: Quip_Version__Gv_Item_Version_Id_FK
                    table: GV_ITEM_VERSION
                    column: Gv_Item_Version_Id
                    relationship: owner

        # As each kind of media is created, use a new column.  When multiple
        # media kinds are in place, switch these to be NULL (rather than
        # NOT NULL), so that a NULL value will indicate that that kind of media
        # isn't available.
        - column:
            name: Text_Value
            type: nvarchar(2048)
            constraints:
                - constraint:
                    type: not null

        # Tags are directly associated with the
        # quip versions, rather than as independent objects.  This makes
        # queries and server requests much lighter weight, at the cost of
        # some ugly sql, and a hard-coded limit to the number of tags.
        # The tags here are not stored in a central repository and then
        # referenced via foreign keys.
        - column:
            name: Tag_1
            type: nvarchar(64)
        - column:
            name: Tag_2
            type: nvarchar(64)
        - column:
            name: Tag_3
            type: nvarchar(64)
        - column:
            name: Tag_4
            type: nvarchar(64)
        - column:
            name: Tag_5
            type: nvarchar(64)
        - column:
            name: Tag_6
            type: nvarchar(64)
        - column:
            name: Tag_7
            type: nvarchar(64)
        - column:
            name: Tag_8
            type: nvarchar(64)
        - column:
            name: Tag_9
            type: nvarchar(64)
        - column:
            name: Tag_10
            type: nvarchar(64)
        - column:
            name: Tag_11
            type: nvarchar(64)
        - column:
            name: Tag_12
            type: nvarchar(64)
        - column:
            name: Tag_13
            type: nvarchar(64)
        - column:
            name: Tag_14
            type: nvarchar(64)
        - column:
            name: Tag_15
            type: nvarchar(64)
        - column:
            name: Tag_16
            type: nvarchar(64)
        - column:
            name: Tag_17
            type: nvarchar(64)
        - column:
            name: Tag_18
            type: nvarchar(64)
        - column:
            name: Tag_19
            type: nvarchar(64)
        - column:
            name: Tag_20
            type: nvarchar(64)


        - column:
            name: Timestamp_Millis
            type: int
            constraints:
                - constraint:
                    type: not null

        - column:
            name: Created_On
            type: timestamp
            constraints:
                - constraint:
                    type: not null
                - constraint:
                    type: no update
                - constraint:
                    type: initial value
                    dialects:
                        - dialect:
                            platforms: mysql
                            sql: NOW()
        - column:
            name: Last_Updated_On
            type: timestamp
            constraints:
                - constraint:
                    type: nullable
                - constraint:
                    type: constant update
                    dialects:
                        - dialect:
                            platforms: mysql
                            sql: NOW()
                - constraint:
                    type: initial value
                    value: "NULL"
